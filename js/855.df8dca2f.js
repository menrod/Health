"use strict";(globalThis["webpackChunkmyhealth"]=globalThis["webpackChunkmyhealth"]||[]).push([[855],{1009:(e,a,l)=>{l.d(a,{s:()=>s});var t=l(705);const s=(0,t.nY)("userAuth",{state:()=>({user:{id:"",role:"",patients:[]}}),getters:{getData:e=>e.user},actions:{logout(){localStorage.clear()},setData(e){this.$state.user={id:e.id??"",role:e.role??"",patients:e.patients??[]}},loadData(){return localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):{}}}})},2855:(e,a,l)=>{l.r(a),l.d(a,{default:()=>A});var t=l(1347),s=l(4187),o=l(3031),r=l(144),i=l(9667),u=l(1009),n=l(455);const d=(0,t.pM)({__name:"loginPage",setup(e){const a=(0,n.rd)(),l=(0,u.s)(),d=(0,s.KR)({email:"",password:""}),c=(0,s.KR)({id:"",role:"",patients:[]}),p=(0,s.KR)(!1),g=async()=>{r.A.create({spinner:i.A,message:"Working...",position:"top",timeout:1e3});const{data:e,error:t}=await o.supabase.auth.signInWithPassword({email:d.value.email,password:d.value.password});if(console.log(e),t)r.A.create({color:"negative",message:"Danger Theres a problem during login",position:"top"});else{c.value.id=e.user.id;const t=await m(e.user.id);c.value.role=t.role,c.value.patients=t.patients,console.log("User Details",c.value),l.setData(c.value),await a.push("/Profile")}};async function m(e){const{data:a,error:l}=await o.supabase.from("Roles").select("*").eq("id",e);if(!l)return a[0];console.log("Role",l)}return(e,a)=>{const l=(0,t.g2)("q-input"),s=(0,t.g2)("q-icon"),o=(0,t.g2)("q-btn"),r=(0,t.g2)("q-form"),i=(0,t.g2)("q-card-section"),u=(0,t.g2)("q-card"),n=(0,t.g2)("q-page"),c=(0,t.g2)("q-page-container"),m=(0,t.g2)("q-layout");return(0,t.uX)(),(0,t.Wv)(m,{view:"lHh Lpr fff"},{default:(0,t.k6)(()=>[(0,t.bF)(c,null,{default:(0,t.k6)(()=>[(0,t.bF)(n,{class:"flex flex-center bg-grey-2"},{default:(0,t.k6)(()=>[(0,t.bF)(u,{class:"q-pa-lg shadow-2"},{default:(0,t.k6)(()=>[(0,t.bF)(i,null,{default:(0,t.k6)(()=>[(0,t.bF)(r,{onSubmit:g},{default:(0,t.k6)(()=>[(0,t.bF)(l,{modelValue:d.value.email,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value.email=e),label:"Email",filled:"",class:"q-mb-md",rules:[e=>!!e||"Email is required"]},null,8,["modelValue","rules"]),(0,t.bF)(l,{modelValue:d.value.password,"onUpdate:modelValue":a[2]||(a[2]=e=>d.value.password=e),label:"Password",type:p.value?"text":"password",filled:"",class:"q-mb-md",rules:[e=>!!e||"Password is required"]},{append:(0,t.k6)(()=>[(0,t.bF)(s,{name:p.value?"visibility":"visibility_off",onClick:a[1]||(a[1]=e=>p.value=!p.value),class:"cursor-pointer"},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),(0,t.bF)(o,{label:"Sign In",type:"submit",color:"primary",class:"full-width q-mt-md"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});var c=l(6148),p=l(970),g=l(5013),m=l(3341),b=l(222),f=l(3417),v=l(6067),h=l(3933),w=l(9039),q=l(272),k=l.n(q);const y=d,A=y;k()(d,"components",{QLayout:c.A,QPageContainer:p.A,QPage:g.A,QCard:m.A,QCardSection:b.A,QForm:f.A,QInput:v.A,QIcon:h.A,QBtn:w.A})}}]);