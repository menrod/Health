"use strict";(globalThis["webpackChunkmyhealth"]=globalThis["webpackChunkmyhealth"]||[]).push([[855],{1009:(e,a,l)=>{l.d(a,{s:()=>t});var s=l(705);const t=(0,s.nY)("userAuth",{state:()=>({user:{id:"",role:"",patients:[]}}),getters:{getData:e=>e.user},actions:{logout(){localStorage.clear()},setData(e){this.$state.user={id:e.id??"",role:e.role??"",patients:e.patients??[]}}}})},2855:(e,a,l)=>{l.r(a),l.d(a,{default:()=>A});var s=l(1347),t=l(4187),o=l(3031),r=l(144),i=l(9667),n=l(1009),u=l(455);const d=(0,s.pM)({__name:"loginPage",setup(e){const a=(0,u.rd)(),l=(0,n.s)(),d=(0,t.KR)({email:"",password:""}),c=(0,t.KR)({id:"",role:"",patients:[]}),p=(0,t.KR)(!1),g=async()=>{r.A.create({spinner:i.A,message:"Working...",position:"top",timeout:1e3});const{data:e,error:s}=await o.supabase.auth.signInWithPassword({email:d.value.email,password:d.value.password});if(console.log(e),s)r.A.create({color:"negative",message:"Danger Theres a problem during login",position:"top"});else{c.value.id=e.user.id;const s=await m(e.user.id);c.value.role=s.role,c.value.patients=s.patients,console.log("User Details",c.value),l.setData(c.value),await a.push("/Profile")}};async function m(e){const{data:a,error:l}=await o.supabase.from("Roles").select("*").eq("id",e);if(!l)return a[0];console.log("Role",l)}return(e,a)=>{const l=(0,s.g2)("q-input"),t=(0,s.g2)("q-icon"),o=(0,s.g2)("q-btn"),r=(0,s.g2)("q-form"),i=(0,s.g2)("q-card-section"),n=(0,s.g2)("q-card"),u=(0,s.g2)("q-page"),c=(0,s.g2)("q-page-container"),m=(0,s.g2)("q-layout");return(0,s.uX)(),(0,s.Wv)(m,{view:"lHh Lpr fff"},{default:(0,s.k6)(()=>[(0,s.bF)(c,null,{default:(0,s.k6)(()=>[(0,s.bF)(u,{class:"flex flex-center bg-grey-2"},{default:(0,s.k6)(()=>[(0,s.bF)(n,{class:"q-pa-lg shadow-2"},{default:(0,s.k6)(()=>[(0,s.bF)(i,null,{default:(0,s.k6)(()=>[(0,s.bF)(r,{onSubmit:g},{default:(0,s.k6)(()=>[(0,s.bF)(l,{modelValue:d.value.email,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value.email=e),label:"Email",filled:"",class:"q-mb-md",rules:[e=>!!e||"Email is required"]},null,8,["modelValue","rules"]),(0,s.bF)(l,{modelValue:d.value.password,"onUpdate:modelValue":a[2]||(a[2]=e=>d.value.password=e),label:"Password",type:p.value?"text":"password",filled:"",class:"q-mb-md",rules:[e=>!!e||"Password is required"]},{append:(0,s.k6)(()=>[(0,s.bF)(t,{name:p.value?"visibility":"visibility_off",onClick:a[1]||(a[1]=e=>p.value=!p.value),class:"cursor-pointer"},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),(0,s.bF)(o,{label:"Sign In",type:"submit",color:"primary",class:"full-width q-mt-md"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});var c=l(6148),p=l(970),g=l(5013),m=l(3341),b=l(222),f=l(3417),v=l(6067),h=l(3933),w=l(9039),q=l(272),k=l.n(q);const y=d,A=y;k()(d,"components",{QLayout:c.A,QPageContainer:p.A,QPage:g.A,QCard:m.A,QCardSection:b.A,QForm:f.A,QInput:v.A,QIcon:h.A,QBtn:w.A})}}]);