"use strict";(globalThis["webpackChunkmyhealth"]=globalThis["webpackChunkmyhealth"]||[]).push([[325],{1009:(e,l,a)=>{a.d(l,{s:()=>o});var t=a(705);const o=(0,t.nY)("userAuth",{state:()=>({user:{id:"",role:"",patients:[]}}),getters:{getData:e=>e.user},actions:{logout(){localStorage.clear()},setData(e){this.$state.user={id:e.id??"",role:e.role??"",patients:e.patients??[]}},loadData(){return localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):{}}}})},1325:(e,l,a)=>{a.r(l),a.d(l,{default:()=>x});var t=a(1347),o=a(4187),u=a(3031),s=a(1009),r=a(144),n=a(9667);const i={class:"q-pa-md q-gutter-md"},d={key:0,class:"row items-center"},c=(0,t.pM)({__name:"labResultPage",setup(e){const l=new Date,a=(0,s.s)(),c=(0,o.KR)({id:"",role:"",patients:[""]}),p=(0,o.KR)(),m=(0,o.KR)([]),b=[{name:"type",label:"Type of test",align:"left",field:"type",sortable:!0},{name:"test",label:"Test",align:"left",field:"test",sortable:!0},{name:"result_text",label:"Text result",align:"left",field:"result_text"},{name:"result_numeric",label:"Result",align:"left",field:"result_numeric"},{name:"unit",label:"Unit",align:"left",field:"unit"},{name:"date_released",label:"Date Released",align:"left",field:"date_released",sortable:!0}],g=(0,o.KR)(!1),v=(0,o.KR)({id:"",type:"",test:"",result_text:"",result_numeric:0,unit:"",date_released:(0,o.KR)(l)}),f=(0,o.KR)(),y=(0,o.KR)();async function _(){const{data:e,error:l}=await u.supabase.from("Roles").select("id").ilike("full_name",`%${f.value}%`).limit(1).single();return l?(console.log("Patients",l),null):(console.log("Patients",e),e)}async function h(){f.value?(y.value=await _(),y.value?(console.log("Patient ID:",y.value),await k(y.value.id)):(m.value=[],r.A.create({color:"negative",message:"Patient not found",position:"top"}))):r.A.create({color:"negative",message:"Please select a patient",position:"top"})}async function k(e){if(c.value){const{data:l,error:a}=await u.supabase.from("LaboratoryResults").select("*").eq("id",e);a?console.log("LaboratoryResults",a):(m.value=l,console.log("LaboratoryResults",m))}}async function V(e){if(r.A.create({spinner:n.A,message:"Working...",position:"top",timeout:1e3}),c.value){v.value.id=e;const{error:l}=await u.supabase.from("LaboratoryResults").insert(v.value);l?r.A.create({color:"negative",message:"Danger can't add record",position:"top"}):(r.A.create({color:"posteal",message:"Added new medication record",position:"top"}),await k(e))}else r.A.create({message:"Kindly logout and relogin",position:"top"})}function A(){v.value.type="",v.value.test="",v.value.result_text="",v.value.result_numeric=0,v.value.unit=""}return(0,t.sV)(async()=>{try{await a.loadData(),c.value=a.getData,"Patient"===c.value.role?y.value=c.value.id:y.value=await _(),console.log("user",y.value.id),await k(y.value.id)}catch(e){console.error("Error loading user data:",e)}}),(e,l)=>{const a=(0,t.g2)("q-select"),o=(0,t.g2)("q-card-section"),u=(0,t.g2)("q-icon"),s=(0,t.g2)("q-input"),r=(0,t.g2)("q-btn"),n=(0,t.g2)("q-table"),_=(0,t.g2)("q-date"),k=(0,t.g2)("q-card-actions"),R=(0,t.g2)("q-card"),w=(0,t.g2)("q-dialog"),F=(0,t.g2)("q-page"),x=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.Wv)(F,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",i,["Patient"!==c.value.role?((0,t.uX)(),(0,t.CE)("div",d,[(0,t.bF)(a,{class:"col-10",modelValue:f.value,"onUpdate:modelValue":[l[0]||(l[0]=e=>f.value=e),h],options:c.value.patients,label:"Patient Name"},null,8,["modelValue","options"])])):(0,t.Q3)("",!0),(0,t.bF)(R,{bordered:"",class:"col-12"},{default:(0,t.k6)(()=>[(0,t.bF)(o,null,{default:(0,t.k6)(()=>l[11]||(l[11]=[(0,t.Lk)("div",{class:"text-h6"},"Laboratory Results",-1)])),_:1,__:[11]}),(0,t.bF)(o,null,{default:(0,t.k6)(()=>[(0,t.bF)(n,{flat:"",rows:m.value,columns:b,"no-data-label":"I didn't find anything for you",filter:p.value,"rows-per-page-options":[3,6,9,10,0],"row-key":"name",dark:"",color:"primary"},{"top-right":(0,t.k6)(()=>[(0,t.bF)(s,{dark:"",borderless:"",debounce:"300",modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=e=>p.value=e),placeholder:"Search"},{append:(0,t.k6)(()=>[(0,t.bF)(u,{name:"search"})]),_:1},8,["modelValue"]),(0,t.bF)(r,{color:"primary",label:"add",onClick:l[2]||(l[2]=e=>g.value=!0)})]),_:1},8,["rows","filter"]),(0,t.bF)(w,{modelValue:g.value,"onUpdate:modelValue":l[10]||(l[10]=e=>g.value=e),persistent:""},{default:(0,t.k6)(()=>[(0,t.bF)(R,{style:{"min-width":"350px"}},{default:(0,t.k6)(()=>[(0,t.bF)(o,{class:"items-center text-dark"},{default:(0,t.k6)(()=>[(0,t.bF)(s,{bordered:"",modelValue:v.value.type,"onUpdate:modelValue":l[3]||(l[3]=e=>v.value.type=e),label:"Type:",placeholder:"(Example CBC, etc..)",rules:[e=>!!e||"This field should not be blank"]},null,8,["modelValue","rules"]),(0,t.bF)(s,{bordered:"",modelValue:v.value.test,"onUpdate:modelValue":l[4]||(l[4]=e=>v.value.test=e),label:"Test:",placeholder:"(Example RBC,WBC, etc ..)",rules:[e=>!!e||"This field should not be blank"]},null,8,["modelValue","rules"]),(0,t.bF)(s,{bordered:"",modelValue:v.value.result_text,"onUpdate:modelValue":l[5]||(l[5]=e=>v.value.result_text=e),label:"Result Text:",placeholder:"(Example Positive/Negative),Optional"},null,8,["modelValue"]),(0,t.bF)(s,{bordered:"",modelValue:v.value.result_numeric,"onUpdate:modelValue":l[6]||(l[6]=e=>v.value.result_numeric=e),label:"Result Numeric:",placeholder:"(Example 5.5),Optional"},null,8,["modelValue"]),(0,t.bF)(s,{bordered:"",modelValue:v.value.unit,"onUpdate:modelValue":l[7]||(l[7]=e=>v.value.unit=e),label:"Unit:",placeholder:"(Example g/dL),Optional"},null,8,["modelValue"]),(0,t.bF)(_,{title:"Date Issued:",subtitle:"Date medication was issued on",modelValue:v.value.date_released,"onUpdate:modelValue":l[8]||(l[8]=e=>v.value.date_released=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(k,{align:"right"},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.bF)(r,{flat:"",label:"Cancel",color:"primary",onClick:A},null,512),[[x]]),(0,t.bF)(r,{flat:"",label:"Add Laboratory Record",color:"primary",onClick:l[9]||(l[9]=e=>V(y.value.value.id))})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})}}});var p=a(5013),m=a(5484),b=a(3341),g=a(222),v=a(9698),f=a(6067),y=a(3933),_=a(9039),h=a(45),k=a(3713),V=a(5034),A=a(8657),R=a(272),w=a.n(R);const F=c,x=F;w()(c,"components",{QPage:p.A,QSelect:m.A,QCard:b.A,QCardSection:g.A,QTable:v.A,QInput:f.A,QIcon:y.A,QBtn:_.A,QDialog:h.A,QDate:k.A,QCardActions:V.A}),w()(c,"directives",{ClosePopup:A.A})}}]);