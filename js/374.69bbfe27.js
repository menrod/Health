"use strict";(globalThis["webpackChunkmyhealth"]=globalThis["webpackChunkmyhealth"]||[]).push([[374],{1009:(e,a,l)=>{l.d(a,{s:()=>o});var t=l(705);const o=(0,t.nY)("userAuth",{state:()=>({user:{id:"",role:"",patients:[]}}),getters:{getData:e=>e.user},actions:{logout(){localStorage.clear()},setData(e){this.$state.user={id:e.id??"",role:e.role??"",patients:e.patients??[]}},loadData(){return localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):{}}}})},5374:(e,a,l)=>{l.r(a),l.d(a,{default:()=>q});var t=l(1347),o=l(4187),i=l(3031),s=l(1009),d=l(144),n=l(9667);const r={class:"q-pa-md q-gutter-md"},u={key:0,class:"row items-center"},c=(0,t.pM)({__name:"admissionsPage",setup(e){const a=new Date,l=(0,s.s)(),c=(0,o.KR)({id:"",role:"",patients:[""]}),m=(0,o.KR)(),p=(0,o.KR)([]),g=[{name:"hospital_name",label:"Hospital Name",align:"left",field:"hospital_name",sortable:!0},{name:"final_diagnosis",label:"Final Diagnosis",align:"left",field:"final_diagnosis",sortable:!0},{name:"date_admitted",label:"Date Admitted",align:"left",field:"date_admitted",sortable:!0},{name:"date_discharged",label:"Date Discharged",align:"left",field:"date_discharged",sortable:!0}],b=(0,o.KR)(!1),v=(0,o.KR)({id:"",hospital_name:"",final_diagnosis:"",date_admitted:(0,o.KR)(a),date_discharged:(0,o.KR)(a)}),f=(0,o.KR)(),h=(0,o.KR)();async function _(){const{data:e,error:a}=await i.supabase.from("Roles").select("id").ilike("full_name",`%${f.value}%`).limit(1).single();return a?(console.log("Patients",a),null):(console.log("Patients",e),e)}async function A(){f.value?(h.value=await _(),h.value?(console.log("Patient ID:",h.value),await k(h.value.id)):(p.value=[],d.A.create({color:"negative",message:"Patient not found",position:"top"}))):d.A.create({color:"negative",message:"Please select a patient",position:"top"})}async function k(e){if(c.value){const{data:a,error:l}=await i.supabase.from("HospitalAdmission").select("*").eq("id",e);l?console.log("Admission",l):(p.value=a,console.log("Admission",p))}}async function V(e){if(d.A.create({spinner:n.A,message:"Working...",position:"top",timeout:1e3}),c.value){v.value.id=e;const{error:a}=await i.supabase.from("HospitalAdmission").insert(v.value);a?d.A.create({color:"negative",message:"Danger can't add record",position:"top"}):(d.A.create({color:"posteal",message:"Added new medication record",position:"top"}),await k(e))}else d.A.create({message:"Kindly logout and relogin",position:"top"})}function w(){v.value.date_admitted=a,v.value.date_discharged=a,v.value.hospital_name="",v.value.final_diagnosis="",v.value.id="",b.value=!1}return(0,t.sV)(async()=>{try{await l.loadData(),c.value=l.getData,"Patient"===c.value.role?h.value=c.value.id:h.value=await _(),await k(h.value.id)}catch(e){console.error("Error loading user data:",e)}}),(e,a)=>{const l=(0,t.g2)("q-select"),o=(0,t.g2)("q-card-section"),i=(0,t.g2)("q-icon"),s=(0,t.g2)("q-input"),d=(0,t.g2)("q-btn"),n=(0,t.g2)("q-table"),_=(0,t.g2)("q-date"),k=(0,t.g2)("q-card-actions"),F=(0,t.g2)("q-card"),D=(0,t.g2)("q-dialog"),y=(0,t.g2)("q-page"),q=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.Wv)(y,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",r,["Patient"!==c.value.role?((0,t.uX)(),(0,t.CE)("div",u,[(0,t.bF)(l,{class:"col-10",modelValue:f.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>f.value=e),A],options:c.value.patients,label:"Patient Name"},null,8,["modelValue","options"])])):(0,t.Q3)("",!0),(0,t.bF)(F,{bordered:"",class:"col-12"},{default:(0,t.k6)(()=>[(0,t.bF)(o,null,{default:(0,t.k6)(()=>a[9]||(a[9]=[(0,t.Lk)("div",{class:"text-h6"},"Admissions",-1)])),_:1,__:[9]}),(0,t.bF)(o,null,{default:(0,t.k6)(()=>[(0,t.bF)(n,{flat:"",rows:p.value,columns:g,"no-data-label":"I didn't find anything for you",filter:m.value,"rows-per-page-options":[3,6,9,10,0],"row-key":"name",dark:"",color:"primary"},{"top-right":(0,t.k6)(()=>[(0,t.bF)(s,{dark:"",borderless:"",debounce:"300",modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),placeholder:"Search"},{append:(0,t.k6)(()=>[(0,t.bF)(i,{name:"search"})]),_:1},8,["modelValue"]),(0,t.bF)(d,{color:"primary",label:"add",onClick:a[2]||(a[2]=e=>b.value=!0)})]),_:1},8,["rows","filter"]),(0,t.bF)(D,{modelValue:b.value,"onUpdate:modelValue":a[8]||(a[8]=e=>b.value=e),persistent:""},{default:(0,t.k6)(()=>[(0,t.bF)(F,{style:{"min-width":"350px"}},{default:(0,t.k6)(()=>[(0,t.bF)(o,{class:"items-center text-dark"},{default:(0,t.k6)(()=>[(0,t.bF)(s,{bordered:"",modelValue:v.value.hospital_name,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value.hospital_name=e),label:"Hospital Name:",placeholder:"(Example City Hospital)",rules:[e=>!!e||"This field should not be blank"]},null,8,["modelValue","rules"]),(0,t.bF)(s,{bordered:"",modelValue:v.value.final_diagnosis,"onUpdate:modelValue":a[4]||(a[4]=e=>v.value.final_diagnosis=e),label:"Final Diagnosis:",placeholder:"(Example Flu, etc..)",rules:[e=>!!e||"This field should not be blank"]},null,8,["modelValue","rules"]),a[10]||(a[10]=(0,t.Lk)("br",null,null,-1)),(0,t.bF)(_,{title:"Date Admitted:",subtitle:"Date patient was admitted",modelValue:v.value.date_admitted,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value.date_admitted=e)},null,8,["modelValue"]),(0,t.bF)(_,{title:"Date Discharged:",subtitle:"Date patient was discharged",modelValue:v.value.date_discharged,"onUpdate:modelValue":a[6]||(a[6]=e=>v.value.date_discharged=e)},null,8,["modelValue"])]),_:1,__:[10]}),(0,t.bF)(k,{align:"right"},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.bF)(d,{flat:"",label:"Cancel",color:"primary",onClick:w},null,512),[[q]]),(0,t.bF)(d,{flat:"",label:"Add Admission Record",color:"primary",onClick:a[7]||(a[7]=e=>V(h.value.value.id))})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})}}});var m=l(5013),p=l(5484),g=l(3341),b=l(222),v=l(9698),f=l(6067),h=l(3933),_=l(9039),A=l(45),k=l(3713),V=l(5034),w=l(8657),F=l(272),D=l.n(F);const y=c,q=y;D()(c,"components",{QPage:m.A,QSelect:p.A,QCard:g.A,QCardSection:b.A,QTable:v.A,QInput:f.A,QIcon:h.A,QBtn:_.A,QDialog:A.A,QDate:k.A,QCardActions:V.A}),D()(c,"directives",{ClosePopup:w.A})}}]);